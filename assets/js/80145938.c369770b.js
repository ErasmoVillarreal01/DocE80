"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[8075],{2088:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>g,frontMatter:()=>o,metadata:()=>s,toc:()=>T});const s=JSON.parse('{"id":"Utilities/Scripts/Messages/Missions/From_STST","title":"From STST - Mission strated from STST","description":"Overview","source":"@site/docs/Utilities/Scripts/Messages/Missions/From_STST.md","sourceDirName":"Utilities/Scripts/Messages/Missions","slug":"/Utilities/Scripts/Messages/Missions/From_STST","permalink":"/DocE80/docs/Utilities/Scripts/Messages/Missions/From_STST","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"sql","permalink":"/DocE80/docs/tags/sql"},{"inline":true,"label":"message-processing","permalink":"/DocE80/docs/tags/message-processing"},{"inline":true,"label":"scripts","permalink":"/DocE80/docs/tags/scripts"},{"inline":true,"label":"sdm","permalink":"/DocE80/docs/tags/sdm"},{"inline":true,"label":"missions","permalink":"/DocE80/docs/tags/missions"},{"inline":true,"label":"lgv","permalink":"/DocE80/docs/tags/lgv"},{"inline":true,"label":"handling","permalink":"/DocE80/docs/tags/handling"}],"version":"current","frontMatter":{"title":"From STST - Mission strated from STST","tags":["sql","message-processing","scripts","sdm","missions","lgv","handling"]},"sidebar":"techStack","previous":{"title":"Mission strated from AMIS","permalink":"/DocE80/docs/Utilities/Scripts/Messages/Missions/From_AMIS"},"next":{"title":"Missions Processing Scripts","permalink":"/DocE80/docs/Utilities/Scripts/Messages/Missions/intro"}}');var r=t(4848),a=t(8453);const o={title:"From STST - Mission strated from STST",tags:["sql","message-processing","scripts","sdm","missions","lgv","handling"]},i=void 0,l={},T=[{value:"Overview",id:"overview",level:2},{value:"Trigger",id:"trigger",level:2},{value:"Expected Behavior",id:"expected-behavior",level:2},{value:"Example: Simulating mission process from AMIS",id:"example-simulating-mission-process-from-amis",level:2}];function c(e){const n={br:"br",code:"code",h2:"h2",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Source:"})," ",(0,r.jsx)(n.code,{children:"Task Handler"})," (usually ",(0,r.jsx)(n.code,{children:"LGVCS"}),")",(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.strong,{children:"Destination:"})," ",(0,r.jsx)(n.code,{children:"SDM"})]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"STST"})," (Station Status) message is sent by the Task Handler to inform SDM that a stock unit has arrived at the first pick\u2011up position of a conveyor or station. This notification enables SDM to detect that a stock unit is ready for processing, transfer, or mission execution, ensuring synchronized coordination between material\u2011handling equipment and SDM\u2019s internal workflows."]}),"\n",(0,r.jsx)(n.h2,{id:"trigger",children:"Trigger"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Stock unit ready at pick\u2011up position:"}),(0,r.jsx)(n.br,{}),"\n","A stock unit reaches the first pick\u2011up point on a conveyor or station, prompting the Task Handler to notify SDM."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"expected-behavior",children:"Expected Behavior"}),"\n",(0,r.jsxs)(n.p,{children:["Upon receiving an ",(0,r.jsx)(n.code,{children:"STST"})," message:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["SDM ",(0,r.jsx)(n.strong,{children:"registers the station status update"}),", acknowledging that a stock unit is now ready at the pick\u2011up location."]}),"\n",(0,r.jsxs)(n.li,{children:["SDM ",(0,r.jsx)(n.strong,{children:"evaluates any pending missions"})," or handling tasks involving that station and determines whether further actions should be triggered."]}),"\n",(0,r.jsx)(n.li,{children:"SDM maintains synchronization with the Task Handler, ensuring that stock\u2011unit movements continue seamlessly across automated equipment and internal processes."}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"example-simulating-mission-process-from-amis",children:"Example: Simulating mission process from AMIS"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",metastring:'title="Simulate STST mission"',children:"\r\nbegin tran\r\n\r\nDECLARE @ROLLBACK\t\t\tBIT = 0\r\n\r\nDECLARE @PROCESS_PKUP\t\tBIT = 1\r\n\r\nDECLARE @ResultCode\t\t\tint\r\nDECLARE @ResultText\t\t\tnvarchar(max)\r\nDECLARE @ResourceNumber\t\tINT = 11\r\nDECLARE @ResourceType\t\tNVARCHAR(50) = 'SingleFork'\r\nDECLARE @TaskNumber\t\t\tNVARCHAR(50) = 'L00000000010'\r\n\r\nDECLARE @MessageType\t\tNVARCHAR(50)\r\nDECLARE @ReplyMessageType\tNVARCHAR(50)\r\n\r\nDECLARE @Sender\t\t\t\tNVARCHAR(50) = 'debug'\r\nDECLARE @Receiver\t\t\tNVARCHAR(50) = 'debug'\r\nDECLARE @Result\t\t\t\tINT\r\n\r\nDECLARE @TaskInfo\t\t\tHandling.TaskInfo\r\nDECLARE @OpPosInfo\t\t\tHandling.OpPosInfo\r\nDECLARE @StockUnitInfo\t\tHandling.StockUnitInfo\r\nDECLARE @LPNs\t\t\t\tTABLE (LPN nvarchar(50))\r\n\r\nDECLARE\t@rc Int,\r\n\t\t@XmlReplyMessage xml\r\nDECLARE\t@return_value Int\r\n\r\n\r\n\r\n\r\nDECLARE @Lpn NVARCHAR(30) = '202602200856'\r\nupdate Inventory.StockUnit set ShapeCheckResult = 0 where Lpn = @Lpn \r\n\r\n\r\n\r\nDECLARE\t@XmlMessage XML = \r\nN'<Message>\r\n  <Header>\r\n    <Sender>LGVCS</Sender>\r\n    <Receiver>WMS</Receiver>\r\n    <Date>2024-09-13T00:26:02</Date>\r\n    <MessageType>STST</MessageType>\r\n    <MessageId>165075</MessageId>\r\n  </Header>\r\n  <Body>\r\n    <ResourceType>SingleFork</ResourceType>\r\n    <RequestId>1150</RequestId>\r\n    <Column>\r\n      <Source>\r\n        <OpPosInfo OpPointName=\"IBC01_01\" Position=\"1\" Level=\"1\" StackLevel=\"1\" Row=\"1\" OperationHeight=\"0\" DistanceFromBegin=\"0\" DistanceFromEnd=\"0\" />\r\n      </Source>\r\n      <Tracking>\r\n        <StockUnitInfo Position=\"1\" StackLevel=\"1\" Row=\"1\" Lpn=\"' + @Lpn + N'\" Sku=\"\" Quantity=\"0\" Side=\"0\" \r\n\t\tLength=\"0\" Width=\"0\" Height=\"0\" Weight=\"0\" LoadAid=\"0\" QualityStatus=\"0\" ReelDiameter=\"0\" WindingDirection=\"0\" ReelOrientation=\"0\" />\r\n      </Tracking>\r\n    </Column>\r\n    <TruckLoadingSuspended>false</TruckLoadingSuspended>\r\n  </Body>\r\n</Message>\t\r\n'\r\n\r\n/****************************************************************** STST **********************************************************************/\r\nPRINT '****************************************************************** STST **********************************************************************'\r\n\r\n\tEXEC\t@rc = [Handling].[usp_ProcessHandlerMessage_STST]\r\n\t\t\t@XmlMessage = @XmlMessage,\r\n\t\t\t@XmlReplyMessage = @XmlReplyMessage OUTPUT\r\n\r\n\tDELETE FROM @TaskInfo\r\n\tDELETE FROM @OpPosInfo\r\n\tDELETE FROM @StockUnitInfo\r\n\t--SELECT 'RM', @XmlReplyMessage\r\n\r\n\tSET @XmlReplyMessage.modify('delete //Destination[1]')\r\n\tINSERT INTO @TaskInfo\r\n\tSELECT * FROM Handling.ufn_GetTaskInfoFromXmlMsg(@XmlReplyMessage)\r\n\t\t\r\n\tINSERT INTO @OpPosInfo\r\n\tSELECT * FROM Handling.ufn_GetOpPosInfoFromXmlMsg(@XmlReplyMessage)\r\n\t\t\r\n\tINSERT INTO @StockUnitInfo\r\n\tSELECT * FROM Handling.ufn_GetStockUnitInfoFromXmlMsg(@XmlReplyMessage)\r\n\r\n\tSELECT @ReplyMessageType = NULL\r\n\tSELECT @ReplyMessageType = MessageType, @Result = ResultCode FROM @TaskInfo\r\n\t\r\n\tINSERT INTO @LPNs (LPN) SELECT DISTINCT LPN FROM @StockUnitInfo\r\n\r\n\t\r\n\r\n\tSELECT @MessageType = 'STST'\r\n\tSELECT\t@MessageType, @XmlMessage\r\n\tSELECT\t@ReplyMessageType,\t@XmlReplyMessage as N'@XmlReplyMessage'\r\n\tSELECT\t@rc as 'Return Value'\r\n\r\n\r\n/****************************************************************** PKUP **********************************************************************/\r\nPRINT '****************************************************************** PKUP **********************************************************************'\r\n\t\r\n\tIF @ReplyMessageType = 'PQTY' AND @Result = 0 AND @PROCESS_PKUP = 1\r\n\tBEGIN\r\n\r\n\t\tupdate @TaskInfo\r\n\t\t\tset MessageType = 'PKUP',\r\n\t\t\t\tTaskNumber = @TaskNumber,\r\n\t\t\t\tResourceNumber = @ResourceNumber,\r\n\t\t\t\tResourceType = @ResourceType,\r\n\t\t\t\tResultCode = NULL\r\n\r\n\t\tEXEC Handling.usp_CreateXMLMessage \r\n\t\t\t@TaskInfo = @TaskInfo,\r\n\t\t\t@OpPosInfo = @OpPosInfo, \r\n\t\t\t@StockUnitInfo = @StockUnitInfo, \r\n\t\t\t@XmlMessage = @XmlMessage OUT\r\n\r\n\t\tselect @XmlMessage = cast (replace (cast(@XmlMessage as nvarchar(max)), '<Sender>wms</Sender>','<Sender>LGVCS</Sender>') as xml)\r\n\t\t\r\n\t\tEXECUTE @RC = [Handling].[usp_ProcessHandlerMessage_PKUP] \r\n\t\t   @XmlMessage\r\n\t\t  ,@XmlReplyMessage OUTPUT\r\n\t\t  ,@ResultCode OUTPUT\r\n\t\t  ,@ResultText OUTPUT\r\n\r\n\t\tDELETE FROM @TaskInfo\r\n\t\tDELETE FROM @OpPosInfo\r\n\t\tDELETE FROM @StockUnitInfo\r\n\t\r\n\t\tINSERT INTO @TaskInfo\r\n\t\tSELECT * FROM Handling.ufn_GetTaskInfoFromXmlMsg(@XmlReplyMessage)\r\n\t\t\r\n\t\tINSERT INTO @OpPosInfo\r\n\t\tSELECT * FROM Handling.ufn_GetOpPosInfoFromXmlMsg(@XmlReplyMessage)\r\n\t\t\r\n\t\tINSERT INTO @StockUnitInfo\r\n\t\tSELECT * FROM Handling.ufn_GetStockUnitInfoFromXmlMsg(@XmlReplyMessage)\r\n\r\n\t\tDELETE FROM @LPNs\r\n\t\tINSERT INTO @LPNs (LPN) SELECT DISTINCT LPN FROM @StockUnitInfo\r\n\r\n\t\tSELECT @ReplyMessageType = NULL\r\n\t\tSELECT @ReplyMessageType = MessageType FROM @TaskInfo\r\n\r\n\r\n\t\tSELECT @MessageType = 'PKUP'\r\n\t\tSELECT  @MessageType, @XmlMessage\r\n\t\tSELECT\t@ReplyMessageType,\t@XmlReplyMessage as N'@XmlReplyMessage'\r\n\t\tSELECT\t@rc as 'Return Value'\r\n\r\n\r\n\r\n\tEND\r\n\r\n/****************************************************************** ARWD **********************************************************************/\r\nPRINT '****************************************************************** ARWD **********************************************************************'\r\n\t\r\n\tIF @ReplyMessageType = 'MMIS'\r\n\tBEGIN\r\n\t\tupdate @TaskInfo\r\n\t\t\tset MessageType = 'ARWD',\r\n\t\t\t\tTaskNumber = @TaskNumber,\r\n\t\t\t\tResourceNumber = @ResourceNumber,\r\n\t\t\t\tResourceType = @ResourceType\r\n\r\n\r\n\t\tEXEC Handling.usp_CreateXMLMessage \r\n\t\t\t@TaskInfo = @TaskInfo,\r\n\t\t\t@OpPosInfo = @OpPosInfo, \r\n\t\t\t@StockUnitInfo = @StockUnitInfo, \r\n\t\t\t@XmlMessage = @XmlMessage OUT\r\n\r\n\t\tselect @XmlMessage = cast (replace (cast(@XmlMessage as nvarchar(max)), '<Sender>wms</Sender>','<Sender>LGVCS</Sender>') as xml)\r\n\r\n\t\tEXECUTE @RC = [Handling].[usp_ProcessHandlerMessage_ARWD] \r\n\t\t   @XmlMessage\r\n\t\t  ,@XmlReplyMessage OUTPUT\r\n\t\t  ,@ResultCode OUTPUT\r\n\t\t  ,@ResultText OUTPUT\r\n\r\n\t\tDELETE FROM @TaskInfo\r\n\t\tDELETE FROM @OpPosInfo\r\n\t\tDELETE FROM @StockUnitInfo\r\n\t\r\n\t\tINSERT INTO @TaskInfo\r\n\t\tSELECT * FROM Handling.ufn_GetTaskInfoFromXmlMsg(@XmlReplyMessage)\r\n\t\t\r\n\t\tINSERT INTO @OpPosInfo\r\n\t\tSELECT * FROM Handling.ufn_GetOpPosInfoFromXmlMsg(@XmlReplyMessage)\r\n\t\t\r\n\t\tINSERT INTO @StockUnitInfo\r\n\t\tSELECT * FROM Handling.ufn_GetStockUnitInfoFromXmlMsg(@XmlReplyMessage)\r\n\r\n\t\tSELECT @ReplyMessageType = NULL\r\n\t\tSELECT @ReplyMessageType = MessageType FROM @TaskInfo\r\n\r\n\r\n\t\tSELECT @MessageType = 'ARWD'\r\n\t\tSELECT  @MessageType, @XmlMessage\r\n\t\tSELECT\t@ReplyMessageType,\t@XmlReplyMessage as N'@XmlReplyMessage'\r\n\t\tSELECT\t@rc as 'Return Value'\r\n\r\n\t\t\r\n\tEND\r\n\t/****************************************************************** DPAL **********************************************************************/\r\nPRINT '****************************************************************** DPAL **********************************************************************'\r\n\t\r\n\tIF @ReplyMessageType = 'DPOS'\r\n\tBEGIN\r\n\t\tupdate @TaskInfo\r\n\t\t\tset MessageType = 'DPAL',\r\n\t\t\t\tTaskNumber = @TaskNumber,\r\n\t\t\t\tResourceNumber = @ResourceNumber,\r\n\t\t\t\tResourceType = @ResourceType\r\n\t\t\r\n\r\n\t\tEXEC Handling.usp_CreateXMLMessage \r\n\t\t\t@TaskInfo = @TaskInfo,\r\n\t\t\t@OpPosInfo = @OpPosInfo, \r\n\t\t\t@StockUnitInfo = @StockUnitInfo, \r\n\t\t\t@XmlMessage = @XmlMessage OUT\r\n\r\n\r\n\r\n\t\tselect @XmlMessage = cast (replace (cast(@XmlMessage as nvarchar(max)), '<Sender>wms</Sender>','<Sender>LGVCS</Sender>') as xml)\r\n\t\t\r\n\r\n\t\tEXECUTE @RC = [Handling].[usp_ProcessHandlerMessage_DPAL] \r\n\t\t   @XmlMessage\r\n\t\t  ,@XmlReplyMessage OUTPUT\r\n\t\t  ,@ResultCode OUTPUT\r\n\t\t  ,@ResultText OUTPUT\r\n\r\n\t\tDELETE FROM @TaskInfo\r\n\t\tDELETE FROM @OpPosInfo\r\n\t\tDELETE FROM @StockUnitInfo\r\n\t\r\n\t\tINSERT INTO @TaskInfo\r\n\t\tSELECT * FROM Handling.ufn_GetTaskInfoFromXmlMsg(@XmlReplyMessage)\r\n\t\t\r\n\t\tINSERT INTO @OpPosInfo\r\n\t\tSELECT * FROM Handling.ufn_GetOpPosInfoFromXmlMsg(@XmlReplyMessage)\r\n\t\t\r\n\t\tINSERT INTO @StockUnitInfo\r\n\t\tSELECT * FROM Handling.ufn_GetStockUnitInfoFromXmlMsg(@XmlReplyMessage)\r\n\r\n\t\tSELECT @ReplyMessageType = NULL\r\n\t\tSELECT @ReplyMessageType = MessageType FROM @TaskInfo\r\n\r\n\t\tSELECT @MessageType = 'DPAL'\r\n\t\tSELECT  @MessageType, @XmlMessage\r\n\t\tSELECT\t@ReplyMessageType, @XmlReplyMessage as N'@XmlReplyMessage'\r\n\t\tSELECT\t@rc as 'Return Value'\r\n\r\n\r\n\t\t\r\n\tEND\r\n\r\n\r\n\r\n\r\nselect TOP 1 'StockUnitMeasurement', * from Inventory.StockUnitMeasurement order by MeasurementDateTime desc\r\nselect TOP 1 'StockUnitProperties', * from Inventory.StockUnitProperties order by Id desc\r\nselect TOP 1 'StockUnitStorage', * from Warehouse.StockUnitStorage order by PositioningTime desc\r\n\r\n\r\n\r\nIF @ROLLBACK = 1\r\n\trollback\r\nELSE\r\n\tcommit\r\nGO\r\n\r\n\r\n\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",metastring:'title="STST xml template"',children:"<Message>\r\n  <Header>\r\n    <Sender>LGVCS</Sender>\r\n    <Receiver>SDM</Receiver>\r\n    <Date>2012-09-21 14:05:38:000Z</Date>\r\n    <MessageType>STST</MessageType>\r\n    <MessageId>12345</MessageId>\r\n  </Header>\r\n  <Body>\r\n    <RequestId>1</RequestId>\r\n    <ResourceType>Double LGV</ResourceType>\r\n    <Column>\r\n      <Source>\r\n        <OpPosInfo OpPointName = 'CV01' Position = '1' Level = '1' Row = '1' OperationHeight = '400' DistanceFromEnd = '0'/>\r\n      </Source>\r\n      <Tracking>\r\n        <StockUnitInfo Position = '1' StackLevel = '1' Row = '1' Lpn = '12' Sku = 'Sku01' Length = '1000' Width = '1000' Height = '800' Weight = '50' ItemClass = '1' LoadAid = '1' StabilityCode = '1' QualityStatus = '1'/>\r\n      </Tracking>\r\n    </Column>\r\n  </Body>\r\n</Message>\r\n\n"})})]})}function g(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>i});var s=t(6540);const r={},a=s.createContext(r);function o(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);