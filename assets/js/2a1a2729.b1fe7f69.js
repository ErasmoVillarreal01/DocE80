"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[4044],{1182:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>a,default:()=>m,frontMatter:()=>l,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"Utilities/Scripts/Messages/HostMessages/SHP_INS","title":"SHP_INS - Shipment Insert / Update","description":"Overview","source":"@site/docs/Utilities/Scripts/Messages/HostMessages/SHP_INS.md","sourceDirName":"Utilities/Scripts/Messages/HostMessages","slug":"/Utilities/Scripts/Messages/HostMessages/SHP_INS","permalink":"/DocE80/docs/Utilities/Scripts/Messages/HostMessages/SHP_INS","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"sql","permalink":"/DocE80/docs/tags/sql"},{"inline":true,"label":"message-processing","permalink":"/DocE80/docs/tags/message-processing"},{"inline":true,"label":"scripts","permalink":"/DocE80/docs/tags/scripts"},{"inline":true,"label":"sdm","permalink":"/DocE80/docs/tags/sdm"},{"inline":true,"label":"host-messages","permalink":"/DocE80/docs/tags/host-messages"}],"version":"current","frontMatter":{"title":"SHP_INS - Shipment Insert / Update","tags":["sql","message-processing","scripts","sdm","host-messages"]},"sidebar":"techStack","previous":{"title":"RET_RQS - Retrieval Request","permalink":"/DocE80/docs/Utilities/Scripts/Messages/HostMessages/RET_RQS"},"next":{"title":"SU_CHG - Stock Unit Change","permalink":"/DocE80/docs/Utilities/Scripts/Messages/HostMessages/SU_CHG"}}');var r=n(4848),i=n(8453);const l={title:"SHP_INS - Shipment Insert / Update",tags:["sql","message-processing","scripts","sdm","host-messages"]},a=void 0,o={},c=[{value:"Overview",id:"overview",level:2},{value:"Trigger",id:"trigger",level:2},{value:"Expected Behavior",id:"expected-behavior",level:2},{value:"Example: Processing a <code>SHP_INS</code> Message",id:"example-processing-a-shp_ins-message",level:2},{value:"XML Example",id:"xml-example",level:2}];function d(e){const t={br:"br",code:"code",h2:"h2",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Source:"})," ",(0,r.jsx)(t.code,{children:"HOST"}),(0,r.jsx)(t.br,{}),"\n",(0,r.jsx)(t.strong,{children:"Destination:"})," ",(0,r.jsx)(t.code,{children:"SDM"})]}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"SHP_INS"})," message is sent by the HOST system to create or update a batch\u2011mode shipment within SDM. This occurs when a new shipment is requested or when an existing shipment is modified. Upon processing this message, SDM inserts, updates, or deletes deliveries and delivery items according to the details contained in the XML payload, ensuring that the shipment structure reflects the requested changes."]}),"\n",(0,r.jsx)(t.h2,{id:"trigger",children:"Trigger"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"New shipment request:"}),(0,r.jsx)(t.br,{}),"\n","A new batch\u2011mode shipment is created in the HOST system."]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Shipment update:"}),(0,r.jsx)(t.br,{}),"\n","An existing shipment is modified, requiring SDM to adjust delivery and delivery\u2011item information accordingly."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"expected-behavior",children:"Expected Behavior"}),"\n",(0,r.jsxs)(t.p,{children:["Upon receiving an ",(0,r.jsx)(t.code,{children:"SHP_INS"})," message:"]}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsxs)(t.li,{children:["SDM ",(0,r.jsx)(t.strong,{children:"creates or updates the batch\u2011mode shipment"}),", depending on whether the shipment already exists."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Deliveries and delivery items are inserted, updated, or deleted"})," based on the content of the incoming message."]}),"\n",(0,r.jsxs)(t.li,{children:["SDM invokes the appropriate shipment\u2011processing logic:","\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.code,{children:"[Shipping].[usp_ProcessShipmentCreationXml]"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.code,{children:"[Shipping].[usp_ProcessShipmentUpdateXml]"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["SDM also calls the internal procedure","\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"[Shipping].[usp_ProcessDeliveryXml]"}),(0,r.jsx)(t.br,{}),"\n","to adjust deliveries and delivery items and ensure full alignment of the shipment structure with the data received from HOST."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsxs)(t.h2,{id:"example-processing-a-shp_ins-message",children:["Example: Processing a ",(0,r.jsx)(t.code,{children:"SHP_INS"})," Message"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sql",metastring:'title="Simulate SHP_INS processing"',children:"SET TRANSACTION ISOLATION LEVEL READ COMMITTED\r\nDECLARE\t@return_value Int,\r\n\t\t@XmlReplyMessage xml,\r\n\t\t@ResultCode INT,\r\n\t\t@ResultText NVARCHAR(max)\r\n\r\n\r\nbegin tran\r\n\r\n\r\n--<Task>\r\n--    <Item></Item>\r\n--    <Quantity></Quantity>\r\n--    <QualityStatus></QualityStatus>\r\n--    <MinExpireDays></MinExpireDays>\r\n--    <RequestId>2025051202</RequestId>\r\n--    <AllocationMethod></AllocationMethod>\r\n--    <SSCC>202505120000000913</SSCC>\r\n--    <EnforceLPN>true</EnforceLPN>\r\n--    <Casepicking>true</Casepicking>\r\n--</Task>\r\n\r\n\r\nEXEC\t@return_value = [Integration].[usp_ProcessHostMessage_SHIP_INS]\r\n\t\t@XmlMessage = N'<Document>\r\n  <Header>\r\n    <Sender>HOST</Sender>\r\n    <Receiver>E80</Receiver>\r\n    <SendDate>2023-09-12T18:05:38+02:00</SendDate>\r\n    <MessageType>SHP_INS</MessageType>\r\n    <MessageId>12345</MessageId>\r\n  </Header>\r\n <Body>\r\n\t<ShipmentNumber>1000004</ShipmentNumber>\r\n\t<DueDateTime>2025-11-20T08:00:00</DueDateTime>\r\n\t<Swap></Swap>\r\n\t<LiveLoad></LiveLoad>\r\n\t<Deliveries>\r\n\t\t<Delivery>\r\n\t\t\t<DeliveryNumber>10001</DeliveryNumber>\r\n\t\t\t<DeliverySequence>1</DeliverySequence>\r\n\t\t\t<DeliveryItem>\r\n\t\t\t\t<Item>1001</Item>\r\n\t\t\t\t<Quantity>10</Quantity>\r\n\t\t\t\t<Lot></Lot>\r\n\t\t\t</DeliveryItem>\r\n\t\t</Delivery>\r\n\r\n\t\t<Delivery>\r\n\t\t\t<DeliveryNumber>10002</DeliveryNumber>\r\n\t\t\t<DeliverySequence>1</DeliverySequence>\r\n\t\t\t<DeliveryItem>\r\n\t\t\t\t<Item>1002</Item>\r\n\t\t\t\t<Quantity>99</Quantity>\r\n\t\t\t\t<Lot></Lot>\r\n\t\t\t</DeliveryItem>\r\n\t\t</Delivery>\r\n\t\t\r\n\t</Deliveries>\r\n\t</Body>\r\n</Document>\r\n',\r\n\r\n\r\n\t\t@XmlReplyMessage = @XmlReplyMessage OUTPUT,\r\n\t\t@ResultCode = @ResultCode OUT,\r\n\t\t@ResultText = @ResultText OUT\r\n\r\nSELECT\t@XmlReplyMessage as N'@XmlReplyMessage'\r\n\r\nSELECT\t@return_value as 'Return Value', @ResultCode ResultCode, @ResultText ResultText\r\n\r\n\r\n\r\nselect 'Shipment', * from Shipping.Shipment\r\nselect 'Delivery', * from Shipping.Delivery\r\nselect 'DeliveryItem', * from Shipping.DeliveryItem\r\nselect 'TransportOrder', Id_Shipment, * from Handling.TransportOrder\r\nselect 'Lot', * from Inventory.Lot order by Id desc\r\n\r\nROLLBACK tran\r\n\r\n\n"})}),"\n",(0,r.jsx)(t.h2,{id:"xml-example",children:"XML Example"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-xml",metastring:'title="SHP_INS xml template"',children:"<Document>\r\n  <Header>\r\n    <Sender>HOST</Sender>\r\n    <Receiver>E80</Receiver>\r\n    <SendDate>2012-09-12 18:05:38+02.00</SendDate>\r\n    <MessageType>SHP_INS</MessageType>\r\n    <MessageId>12345</MessageId>\r\n  </Header>\r\n  <Body>\r\n    <ShipmentNumber>012223</ShipmentNumber>\r\n    <Priority>2</Priority>\r\n    <DueDateTime>2012-09-12 20:00:00+02.00</DueDateTime>\r\n    <StagingArea>AREA01</StagingArea>\r\n    <Dock>DOCK01</Dock>\r\n    <Deliveries>\r\n      <Delivery>\r\n        <DeliverySequence>1</DeliverySequence>\r\n        <DeliveryItem>\r\n          <Item>ITEM-01</Item>\r\n          <Quantity>360</Quantity>\r\n        </DeliveryItem> \r\n        <DeliveryItem>\r\n          <Item>ITEM-02</Item>\r\n          <Quantity>480</Quantity>\r\n        </DeliveryItem> \r\n        <DeliveryItem>\r\n          <Item>ITEM-03</Item>\r\n          <Quantity>240</Quantity>\r\n        </DeliveryItem> \r\n      </Delivery>\r\n    </Deliveries>\r\n  </Body>\r\n</Document>\r\n\n"})})]})}function m(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>a});var s=n(6540);const r={},i=s.createContext(r);function l(e){const t=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);