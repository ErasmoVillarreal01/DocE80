"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[206],{1188:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"BFF/CreateNewApi","title":"YETR","description":"This page will talk about the different steps and requirments needed to create a page from scratch.","source":"@site/docs/BFF/CreateNewApi.md","sourceDirName":"BFF","slug":"/BFF/CreateNewApi","permalink":"/DocE80/docs/BFF/CreateNewApi","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"queries","previous":{"title":"Controller","permalink":"/DocE80/docs/BFF/Controller"},"next":{"title":"Where Models Are Used","permalink":"/DocE80/docs/BFF/Model"}}');var t=r(4848),i=r(8453);const o={},l="YETR",d={},a=[{value:"<strong>Step 1: Define the WebUI Page Functionality</strong>",id:"step-1-define-the-webui-page-functionality",level:2},{value:"<strong>Step 2: Create the required Stored Procedure(s)</strong>",id:"step-2-create-the-required-stored-procedures",level:2},{value:"<strong>Step 3: Create the Required View(s)</strong>",id:"step-3-create-the-required-views",level:2},{value:"<strong>Step 4: Update <code>DbContext.cs</code></strong>",id:"step-4-update-dbcontextcs",level:2},{value:"<strong>4.1 Prepare the DbContext for the Update</strong>",id:"41-prepare-the-dbcontext-for-the-update",level:3},{value:"<strong>4.2 Scaffold the New View</strong>",id:"42-scaffold-the-new-view",level:3},{value:"<strong>4.3 Transfer the View Definitions</strong>",id:"43-transfer-the-view-definitions",level:3},{value:"<strong>4.4 Finalize the Context Update</strong>",id:"44-finalize-the-context-update",level:3},{value:"<strong>Step 5: Create a New Project (if needed)</strong>",id:"step-5-create-a-new-project-if-needed",level:2},{value:"<strong>5.1 Create the Project</strong>",id:"51-create-the-project",level:3},{value:"<strong>5.2 Create the Base Folder Structure</strong>",id:"52-create-the-base-folder-structure",level:3},{value:"<strong>Step 6: Create the Required Model(s)</strong>",id:"step-6-create-the-required-models",level:2},{value:"<strong>6.1 ReadModels (for views)</strong>",id:"61-readmodels-for-views",level:3},{value:"<strong>6.2 WriteModels / InputModels (for procedures)</strong>",id:"62-writemodels--inputmodels-for-procedures",level:3},{value:"<strong>Step 7: Create the Required Service(s)</strong>",id:"step-7-create-the-required-services",level:2},{value:"<strong>Step 8: Create the Required Controller(s)</strong>",id:"step-8-create-the-required-controllers",level:2},{value:"<strong>Step 9: Test API actions (not necessary but recomended)</strong>",id:"step-9-test-api-actions-not-necessary-but-recomended",level:2},{value:"<strong>9.2 Postman</strong>",id:"92-postman",level:3},{value:"<strong>Step 10: Publish new API or Page</strong>",id:"step-10-publish-new-api-or-page",level:2},{value:"<strong>Step 11: Create new WebUi page</strong>",id:"step-11-create-new-webui-page",level:2}];function c(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"yetr",children:"YETR"})}),"\n",(0,t.jsx)(n.p,{children:"This page will talk about the different steps and requirments needed to create a page from scratch."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"step-1-define-the-webui-page-functionality",children:(0,t.jsx)(n.strong,{children:"Step 1: Define the WebUI Page Functionality"})}),"\n",(0,t.jsx)(n.p,{children:"Before any development begins, the analyst should clearly determine the expected behavior of the WebUI page."}),"\n",(0,t.jsx)(n.p,{children:"To do this, the following guiding questions must be answered:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"What is the expected behavior of the page?"}),(0,t.jsx)(n.br,{}),"\n","Identify its main purpose and what the user should accomplish with it."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Will the page only display data, or will it allow actions such as adding, editing, or deleting records?"}),(0,t.jsx)(n.br,{}),"\n","This defines whether backend procedures will be required."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Which elements must be visible on the page?"}),(0,t.jsx)(n.br,{}),"\n","List all fields, tables, filters, buttons, and dynamic sections needed."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"What layout structure will the new page follow?"}),(0,t.jsx)(n.br,{}),"\n","Examples include:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Fixed one\u2011section layout"}),"\n",(0,t.jsx)(n.li,{children:"Fixed two\u2011section layout"}),"\n",(0,t.jsx)(n.li,{children:"Fixed three\u2011section layout"}),"\n",(0,t.jsx)(n.li,{children:"Any custom arrangement required by the design"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Will buttons or additional features be necessary?"}),(0,t.jsx)(n.br,{}),"\n","Consider actions such as \u201cSave,\u201d \u201cDelete,\u201d \u201cExport,\u201d \u201cRefresh,\u201d or any other interactive functionality."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)("br",{}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"step-2-create-the-required-stored-procedures",children:(0,t.jsx)(n.strong,{children:"Step 2: Create the required Stored Procedure(s)"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"(Applicable when the page performs actions other than simply displaying data.)"})}),"\n",(0,t.jsx)(n.p,{children:"If the WebUI page needs to execute an operation \u2014 such as inserting, updating, deleting, or executing logic \u2014 a dedicated stored procedure must be created."}),"\n",(0,t.jsxs)(n.p,{children:["The procedure should contain ",(0,t.jsx)(n.strong,{children:"all logic required for the corresponding action"}),", ensuring that the WebUI receives a consistent and structured response."]}),"\n",(0,t.jsxs)(n.p,{children:["A typical execution pattern is shown below.",(0,t.jsx)(n.br,{}),"\n","Note that BFF endpoints commonly return the result content in ",(0,t.jsx)(n.strong,{children:"XML format"}),", using ",(0,t.jsx)(n.code,{children:"ResultText"})," as the output variable."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"DECLARE @ResultCode INT = 0,\r\n        @ResultText XML = NULL;\r\n\r\nEXEC [`SCHEMA_NAME`].[`PROCEDURE_NAME`]\r\n    @Variable_1 = '`VALUE_1`',\r\n    @Variable_N = '`VALUE_N`',\r\n    @ResultCode = @ResultCode OUT,\r\n    @ResultText = @ResultText OUT;\n"})}),"\n",(0,t.jsx)("br",{}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"step-3-create-the-required-views",children:(0,t.jsx)(n.strong,{children:"Step 3: Create the Required View(s)"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"(Views are used exclusively for data retrieval and presentation.)"})}),"\n",(0,t.jsxs)(n.p,{children:["For each section defined in the selected layout, a dedicated view must be created.",(0,t.jsx)(n.br,{}),"\n","Each view should expose only the variables and fields necessary to display the required information on the WebUI page. Each view must have a variable called Id."]}),"\n",(0,t.jsxs)(n.p,{children:["Only ",(0,t.jsx)(n.strong,{children:"one view per layout section"})," should be created to maintain clarity, modularity, and ease of maintenance."]}),"\n",(0,t.jsx)(n.p,{children:"A standard view definition follows the structure shown below:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"CREATE VIEW [`SCHEMA_NAME`].[`VIEW_NAME`]\r\nAS\r\n\r\nSELECT\r\n    t1.Id,\r\n    t2.Id AS IdTable2,\r\n    t1.Name\r\nFROM [`SCHEMA_NAME`].[`TABLE_NAME_1`] AS t1\r\nLEFT JOIN [`SCHEMA_NAME`].[`TABLE_NAME_2`] AS t2 \r\n    ON t1.Id = t2.Id_Table1\r\nWHERE t2.Id IS NULL;\n"})}),"\n",(0,t.jsx)("br",{}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"step-4-update-dbcontextcs",children:(0,t.jsxs)(n.strong,{children:["Step 4: Update ",(0,t.jsx)(n.code,{children:"DbContext.cs"})]})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"(From this step forward, all actions take place in the BFF code unless stated otherwise.)"})}),"\n",(0,t.jsxs)(n.p,{children:["To expose the newly created views to the BFF project, the Entity Framework context must be updated.",(0,t.jsx)(n.br,{}),"\n","The following procedure must be repeated ",(0,t.jsx)(n.strong,{children:"for each view"})," created in Step 3."]}),"\n",(0,t.jsx)(n.h3,{id:"41-prepare-the-dbcontext-for-the-update",children:(0,t.jsx)(n.strong,{children:"4.1 Prepare the DbContext for the Update"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Navigate to the folder:",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.strong,{children:"SmileE80.Bff.Database \u2192 Context"})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Rename the file:",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.code,{children:"BffDbContext.cs"})," \u2192 ",(0,t.jsx)(n.code,{children:"BffDbContext_.cs"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.em,{children:"(This temporary rename prevents conflicts when scaffolding.)"})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Right\u2011click on the project ",(0,t.jsx)(n.strong,{children:"SmileE80.Bff.Database"})," and select: ",(0,t.jsx)(n.strong,{children:"Set as Startup Project"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"42-scaffold-the-new-view",children:(0,t.jsx)(n.strong,{children:"4.2 Scaffold the New View"})}),"\n",(0,t.jsxs)(n.ol,{start:"4",children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Open the Package Manager Console:",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.strong,{children:"Tools \u2192 NuGet Package Manager \u2192 Package Manager Console"}),(0,t.jsx)(n.br,{}),"\n","Ensure the ",(0,t.jsx)(n.strong,{children:"Default Project"})," (shown at the top of the console) is:",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.strong,{children:"SmileE80.Bff.Database"})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Execute the following command, replacing values inside brackets with your specific information:"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",children:'Scaffold-DbContext "Server=`DATABASE_API`;User ID=`USERNAME`;Password=`PASSWORD`;Database=`DATABSE_NAME`;MultipleActiveResultSets=true;Encrypt=True;TrustServerCertificate=True;" Microsoft.EntityFrameworkCore.SqlServer -OutputDir "Models" -Context "BffDbContext" -DataAnnotations -Project "SmileE80.Bff.Database" -ContextDir "Context" -Tables "`VIEW_NAME`" -Force\n'})}),"\n",(0,t.jsxs)(n.p,{children:["This command will generate a ",(0,t.jsxs)(n.strong,{children:["new ",(0,t.jsx)(n.code,{children:"BffDbContext.cs"})]})," file along with a model for the selected view."]}),"\n",(0,t.jsx)(n.h3,{id:"43-transfer-the-view-definitions",children:(0,t.jsx)(n.strong,{children:"4.3 Transfer the View Definitions"})}),"\n",(0,t.jsxs)(n.ol,{start:"6",children:["\n",(0,t.jsxs)(n.li,{children:["Open the newly generated ",(0,t.jsx)(n.code,{children:"BffDbContext.cs"}),".",(0,t.jsx)(n.br,{}),"\n","Locate the autogenerated definitions for your view. They will resemble:"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'public virtual DbSet<`VIEW_NAME`> `VIEW_NAMES` { get; set; }\r\n\r\nmodelBuilder.Entity<`VIEW_NAME`>(entity =>\r\n{\r\n    entity.ToView("`VIEW_NAME`", "`SCHEMA_NAME`");\r\n    ...\r\n});\n'})}),"\n",(0,t.jsxs)(n.ol,{start:"7",children:["\n",(0,t.jsxs)(n.li,{children:["Copy the relevant ",(0,t.jsx)(n.code,{children:"DbSet"})," and ",(0,t.jsx)(n.code,{children:"modelBuilder"})," sections and paste them into the renamed file: ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"BffDbContext_.cs"})})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"(Only the parts related to the new view should be copied.)"})}),"\n",(0,t.jsx)(n.h3,{id:"44-finalize-the-context-update",children:(0,t.jsx)(n.strong,{children:"4.4 Finalize the Context Update"})}),"\n",(0,t.jsxs)(n.ol,{start:"8",children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Delete the newly generated ",(0,t.jsx)(n.code,{children:"BffDbContext.cs"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Rename the file:",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.code,{children:"BffDbContext_.cs"})," \u2192 ",(0,t.jsx)(n.code,{children:"BffDbContext.cs"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.em,{children:"(Restoring the context with the added view mappings.)"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Inside the folder Models, the added views should appear."}),"\n"]}),"\n",(0,t.jsx)("br",{}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"step-5-create-a-new-project-if-needed",children:(0,t.jsx)(n.strong,{children:"Step 5: Create a New Project (if needed)"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.em,{children:["(If the target folder for your page already exists within an API project, ",(0,t.jsx)(n.strong,{children:"skip this step"}),".)"]})}),"\n",(0,t.jsx)(n.p,{children:"When a new API is required, create a dedicated ASP.NET Core project that will run under IIS."}),"\n",(0,t.jsx)(n.h3,{id:"51-create-the-project",children:(0,t.jsx)(n.strong,{children:"5.1 Create the Project"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["In Visual Studio: ",(0,t.jsx)(n.strong,{children:"File \u2192 New \u2192 Project"})]}),"\n",(0,t.jsxs)(n.li,{children:["Choose ",(0,t.jsx)(n.strong,{children:"ASP.NET Core Empty"})," (C#)."]}),"\n",(0,t.jsxs)(n.li,{children:["Name the project following the convention:",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.code,{children:"SmilE80.Bff.PROJECT_NAME"})]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"52-create-the-base-folder-structure",children:(0,t.jsx)(n.strong,{children:"5.2 Create the Base Folder Structure"})}),"\n",(0,t.jsx)(n.p,{children:"Inside the new project, create the following folders:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"    SmilE80.Bff.`PROJECT_NAME`\r\n     \u251c\u2500 Controllers\r\n     \u251c\u2500 Services\r\n     \u2514\u2500 Models\r\n         \u251c\u2500 ReadModels\r\n         \u2514\u2500 WriteModels\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/DocE80/docs/BFF/Model",children:"Models"})})," \u2192 Classes used to ",(0,t.jsx)(n.strong,{children:"shape input/output data"})," for the API."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/DocE80/docs/BFF/Service",children:"Services"})})," \u2192 Classes that ",(0,t.jsx)(n.strong,{children:"encapsulate business logic"})," and orchestration."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/DocE80/docs/BFF/Controller",children:"Controllers"})})," \u2192 API endpoints that ",(0,t.jsx)(n.strong,{children:"receive requests and return responses"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.em,{children:"Tip:"})," Keep the naming consistent with the feature/page being implemented. Example: ",(0,t.jsx)(n.code,{children:"PutawayOrderController"}),", ",(0,t.jsx)(n.code,{children:"PutawayOrderService"}),", ",(0,t.jsx)(n.code,{children:"PutawayOrderReadModel"}),"."]}),"\n"]}),"\n",(0,t.jsx)("br",{}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"step-6-create-the-required-models",children:(0,t.jsx)(n.strong,{children:"Step 6: Create the Required Model(s)"})}),"\n",(0,t.jsxs)(n.p,{children:["The number and type of models depend on what was built in ",(0,t.jsx)(n.strong,{children:"Step 2 (procedures)"})," and ",(0,t.jsx)(n.strong,{children:"Step 3 (views)"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["For ",(0,t.jsx)(n.strong,{children:"views"})," \u2192 create ",(0,t.jsx)(n.strong,{children:"ReadModels"})," (output)."]}),"\n",(0,t.jsxs)(n.li,{children:["For ",(0,t.jsx)(n.strong,{children:"procedures"})," \u2192 create ",(0,t.jsx)(n.strong,{children:"WriteModels"})," (input)."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"61-readmodels-for-views",children:(0,t.jsx)(n.strong,{children:"6.1 ReadModels (for views)"})}),"\n",(0,t.jsxs)(n.p,{children:["A ",(0,t.jsx)(n.strong,{children:"ReadModel"})," should include the ",(0,t.jsx)(n.strong,{children:"fields returned by the view"})," created in Step 3.",(0,t.jsx)(n.br,{}),"\n","If using AutoMapper with EF (entity framework) entities from ",(0,t.jsx)(n.code,{children:"SmileE80.Bff.Database.Models"}),", annotate with ",(0,t.jsx)(n.code,{children:"[AutoMap]"}),"."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"using AutoMapper;\r\nusing SmilE80.Bff.Database.Models;\r\n\r\nnamespace SmilE80.Bff.`PROJECT_NAME`.Models.ReadModels\r\n{\r\n    // Maps to EF entity generated from [`SCHEMA_NAME`].[`VIEW_NAME`]\r\n    [AutoMap(typeof(`VIEW_NAME`), ReverseMap = false)]\r\n    public class `VIEW_NAME_ReadModel`\r\n    {\r\n        // variables used in the view\r\n        public int Id { get; set; }\r\n        public int IdTable2 { get; set; }\r\n        public string Name { get; set; }\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Guidelines"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Include only fields needed by the WebUI."}),"\n",(0,t.jsx)(n.li,{children:"Keep these classes simple (no business logic)."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"62-writemodels--inputmodels-for-procedures",children:(0,t.jsx)(n.strong,{children:"6.2 WriteModels / InputModels (for procedures)"})}),"\n",(0,t.jsxs)(n.p,{children:["A ",(0,t.jsx)(n.strong,{children:"WriteModel"})," represents the ",(0,t.jsx)(n.strong,{children:"input contract"})," required by the stored procedure(s) from Step 2."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"namespace SmilE80.Bff.`PROJECT_NAME`.Models.WriteModels\r\n{\r\n    public class `PROCEDURE_NAME_WriteModel`    \r\n    {\r\n        public string Variable_1 { get; set; }\r\n        public string Variable_N { get; set; }\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Guidelines"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Prefer action\u2011based names, e.g., ",(0,t.jsx)(n.code,{children:"GeneratePutawayOrderInputModel"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Add validation attributes where applicable (",(0,t.jsx)(n.code,{children:"[Required]"}),", ",(0,t.jsx)(n.code,{children:"[StringLength]"}),", etc.)."]}),"\n"]}),"\n",(0,t.jsx)("br",{}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"step-7-create-the-required-services",children:(0,t.jsx)(n.strong,{children:"Step 7: Create the Required Service(s)"})}),"\n",(0,t.jsxs)(n.p,{children:["A dedicated ",(0,t.jsx)(n.strong,{children:"service"})," must be created for each page.",(0,t.jsx)(n.br,{}),"\n","The service acts as the ",(0,t.jsx)(n.strong,{children:"intermediate layer"})," between the controller and the database. It retrieves data from ",(0,t.jsx)(n.strong,{children:"views"})," (via the DbContext) and executes ",(0,t.jsx)(n.strong,{children:"stored procedures"})," created in Step 2."]}),"\n",(0,t.jsx)(n.p,{children:"Below is an example structure:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'using AutoMapper;\r\nusing Microsoft.Data.SqlClient;\r\nusing SmilE80.AspNetCore.Common.DAL;\r\nusing SmilE80.AspNetCore.Common.QueryPaging;\r\nusing SmilE80.AspNetCore.Common.QuerySorting;\r\nusing SmilE80.Bff.Database.Context;\r\nusing SmilE80.Bff.Database.Models;\r\nusing SmilE80.Bff.`PROJECT_NAME`.Models.ReadModels;\r\nusing SmilE80.Bff.`PROJECT_NAME`.Models.WriteModels;\r\nusing System.Data;\r\n\r\nnamespace SmilE80.Bff.`PROJECT_NAME`.Services\r\n{\r\n    public class `SERVICE_NAME` : IService\r\n    {\r\n        private readonly BffDbContext _bffDbContext;\r\n        private readonly IMapper _mapper;\r\n\r\n        public `SERVICE_NAME`(BffDbContext bffDbContext, IMapper mapper)\r\n        {\r\n            _bffDbContext = bffDbContext;\r\n            _mapper = mapper;\r\n        }\r\n\r\n        // One method per view (Read)\r\n        public async Task<(IEnumerable<`VIEW_NAME_ReadModel`> Values, QueryPaginationResult PaginationResult)> `Get_VIEW_NAME`(string filters, QuerySort sorting, QueryPage paginator)\r\n                => await _mapper.GetQueryData<`VIEW_NAME_ReadModel`, `VIEW_NAME`>(_bffDbContext, filters, sorting, paginator);\r\n                \r\n        // One method per procedure (Write)\r\n        public async Task `Create_PROCEDURE_NAME`(`PROCEDURE_NAME_WriteModel` item, string userName)\r\n        {\r\n            var key = "`PROCEDURE_NAME`"; // Identifier for diagnostics/logging\r\n\r\n            var spText = @"[`SCHEMA_NAME`].[`PROCEDURE_NAME`]\r\n                            @Variable_1,\r\n                            @Variable_N";\r\n\r\n            var parameters = new[]\r\n            {\r\n                new SqlParameter("@Variable_1", SqlDbType.NVarChar) { Value = item.Variable_1 },\r\n                new SqlParameter("@Variable_N", SqlDbType.NVarChar) { Value = item.Variable_N },\r\n            };\r\n\r\n            await _bffDbContext.ExecuteStoredProcedure(key, spText, parameters);\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Conventions"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Read methods"}),": ",(0,t.jsx)(n.code,{children:"Get + View Name"})," (e.g., ",(0,t.jsx)(n.code,{children:"GetPutawayOrdersAsync"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Write methods"}),": ",(0,t.jsx)(n.code,{children:"Action + Entity Name"})," (e.g., ",(0,t.jsx)(n.code,{children:"CreatePutawayOrderAsync"}),")."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Best Practices"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Logic should be minimal. No formatting, UI logic, or view-specific transformations."}),"\n",(0,t.jsxs)(n.li,{children:["Create a unique ",(0,t.jsx)(n.code,{children:"key"})," value (identifier for logging and diagnostics)."]}),"\n",(0,t.jsx)(n.li,{children:"Pass SQL parameters in the exact order expected by the procedure."}),"\n",(0,t.jsx)(n.li,{children:"Avoid returning raw SQL data (the WebUI only needs the result message)."}),"\n"]}),"\n",(0,t.jsx)("br",{}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"step-8-create-the-required-controllers",children:(0,t.jsx)(n.strong,{children:"Step 8: Create the Required Controller(s)"})}),"\n",(0,t.jsxs)(n.p,{children:["Controllers ",(0,t.jsx)(n.strong,{children:"expose API endpoints"}),", call the ",(0,t.jsx)(n.strong,{children:"service"}),", and handle ",(0,t.jsx)(n.strong,{children:"input validation"})," and ",(0,t.jsx)(n.strong,{children:"HTTP responses"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["One controller per section in a page/feature.",(0,t.jsx)(n.br,{}),"\n","Endpoints:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"GET"})," for views (read)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"POST/PUT/DELETE"})," for procedures (write actions)."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'using Microsoft.AspNetCore.Authorization;\r\nusing Microsoft.AspNetCore.Mvc;\r\nusing SmilE80.AspNetCore.Common.ApiVersioning;\r\nusing SmilE80.AspNetCore.Common.Authentication;\r\nusing SmilE80.AspNetCore.Common.Authorization.DefaultPermissions;\r\nusing SmilE80.AspNetCore.Common.ComboboxAPIs;\r\nusing SmilE80.AspNetCore.Common.Models;\r\nusing SmilE80.AspNetCore.Common.QueryPaging;\r\nusing SmilE80.AspNetCore.Common.QuerySorting;\r\nusing SmilE80.Bff.Database.Context;\r\nusing SmilE80.Bff.`PROJECT_NAME`.Models.ReadModels;\r\nusing SmilE80.Bff.`PROJECT_NAME`.Models.WriteModels;\r\nusing SmilE80.Bff.`PROJECT_NAME`.Services;\r\n\r\nnamespace SmilE80.Bff.`PROJECT_NAME`.Controllers\r\n{\r\n    [Route("api/`PROJECT_NAME`/[controller]"), ApiController]\r\n    [Authorize(Policy = "ApiNamePolicy")]\r\n    public class Controller : ControllerBase\r\n    {\r\n        private readonly `SERVICE_NAME` _service;\r\n\r\n        public `FEATURE_NAME_Controller`(`SERVICE_NAME` service)\r\n        {\r\n            _service = service;\r\n        }\r\n\r\n        // Returns paged, sorted, and filtered data from [`SCHEMA_NAME`].[`VIEW_NAME`].\r\n        [DefaultPermission(RoleType.None, RoleType.None, RoleType.Supervisor | RoleType.Operator | RoleType.Viewer)]\r\n        [HttpGet, ApiVersioning("1.0.0")]\r\n        public async Task<ListOfDtoResults<`VIEW_NAME_ReadModel`>> `Get_VIEW_NAME`(string filters, QuerySort sorting, QueryPage paginator)\r\n        {\r\n            var pagedResult = await _service.`Get_VIEW_NAME`(filters, sorting, paginator);\r\n            return new ListOfDtoResults<`VIEW_NAME_ReadModel`>(pagedResult.Values, pagedResult.PaginationResult);\r\n        }\r\n\r\n        // Executes [`SCHEMA_NAME`].[`PROCEDURE_NAME`].\r\n        [DefaultPermission(RoleType.None, RoleType.Supervisor | RoleType.Operator, RoleType.None)]\r\n        [HttpPost("`PROCEDURE_NAME`"), ApiVersioning("1.0.0")]\r\n        public async Task `Create_PROCEDURE_NAME`([FromBody] ProcedureNameWriteModel item)\r\n            => await _service.`Create_PROCEDURE_NAME`(item, User.GetUserName());\r\n\r\n        // In case a combobox is needed\r\n        [DefaultPermission(RoleType.None, RoleType.None, RoleType.Supervisor | RoleType.Operator | RoleType.Viewer)]\r\n        [HttpGet("`Get_TABLE_NAME`"), ApiVersioning("1.0.0")]\r\n        [EnableCombobox(nameof(BffDbContext), "`SCHEMA_NAME`.`TABLE_NAME`", "`VALUE_FIELD`", "`LABEL_FIELD`")]\r\n        public object `Get_TABLE_NAME`()\r\n        {\r\n            throw new ComboBoxOnlyMethodException();\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)("br",{}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"step-9-test-api-actions-not-necessary-but-recomended",children:(0,t.jsx)(n.strong,{children:"Step 9: Test API actions (not necessary but recomended)"})}),"\n",(0,t.jsx)(n.p,{children:"To test the API actions created, there are different platforms to test like postman, swagger, etc."}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/DocE80/docs/BFF/Swagger",children:"Swagger"})})," -> Guide on how to test in Swagger"]}),"\n",(0,t.jsx)(n.h3,{id:"92-postman",children:(0,t.jsx)(n.strong,{children:"9.2 Postman"})}),"\n",(0,t.jsx)("br",{}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"step-10-publish-new-api-or-page",children:(0,t.jsx)(n.strong,{children:"Step 10: Publish new API or Page"})}),"\n",(0,t.jsx)("br",{}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"step-11-create-new-webui-page",children:(0,t.jsx)(n.strong,{children:"Step 11: Create new WebUi page"})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>l});var s=r(6540);const t={},i=s.createContext(t);function o(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);