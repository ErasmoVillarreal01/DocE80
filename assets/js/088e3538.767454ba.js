"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[1031],{6173:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>i,contentTitle:()=>c,default:()=>u,frontMatter:()=>o,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"T-SQL/Routines/Stored Procedures/SP Basics","title":"SP Basics","description":"Stored Procedures are saved queries that can be called and executed. Stored Procedures are similar to Functions and can receive parameters.","source":"@site/techStack/T-SQL/Routines/Stored Procedures/SP Basics.md","sourceDirName":"T-SQL/Routines/Stored Procedures","slug":"/T-SQL/Routines/Stored Procedures/SP Basics","permalink":"/DocE80/techStack/T-SQL/Routines/Stored Procedures/SP Basics","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"techStack","previous":{"title":"Table Valued Functions","permalink":"/DocE80/techStack/T-SQL/Routines/Functions/Table Valued Functions"},"next":{"title":"SP Data Manipulation","permalink":"/DocE80/techStack/T-SQL/Routines/Stored Procedures/SP Data Manipulation"}}');var s=t(4848),a=t(8453);const o={},c=void 0,i={},d=[];function S(e){const r={a:"a",code:"code",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.p,{children:["Stored Procedures are saved queries that can be called and executed. Stored Procedures are similar to ",(0,s.jsx)(r.a,{href:"/DocE80/techStack/T-SQL/Routines/Functions/",children:"Functions"})," and can receive parameters."]}),"\n",(0,s.jsxs)(r.p,{children:["Stored Procedures ",(0,s.jsx)(r.strong,{children:"can"})," perform permanent environmental changes in SQL Server (Ex. ",(0,s.jsx)(r.code,{children:"INSERT"})," or  ",(0,s.jsx)(r.code,{children:"UPDATE"}),")"]}),"\n",(0,s.jsx)(r.p,{children:"General Structure of a Stored Procedure:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-SQL",children:"CREATE PROCEDURE Demo.uspUpdateRepPerformance\r\n\r\nAS\r\nBEGIN\r\n\tSET NOCOUNT ON;\r\n\t\r\n\tSELECT \r\n\tSP.BusinessEntityID AS EmployeeID,\r\n\tSUM(SOD.OrderQty) AS SalesQuantity,\r\n\tSUM(SOD.OrderQty * PRD.ListPrice) AS SalesRevenue,\r\n\tDATEPART(YEAR, SOH.OrderDate) AS OrderYear\r\n\t\r\n\tFROM\r\n\tSales.SalesOrderHeader SOH\r\n\tLEFT JOIN Sales.SalesOrderDetail SOD\r\n\t\tON SOD.SaledOrderID = SOH.SalesOrderID\r\n\tLEFT JOIN Sales.SalesPerson SP\r\n\t\tON SP.BusinessEntityID = SOH.SalesPerson ID\r\n\tLEFT JOIN HumanResources.Employee EMP\r\n\t\tON EMP.BusinessEntityID = SP.BusinessEntityID\r\n\tLEFT JOIN Person.Person PER\r\n\t\tON PER.BusinessEntityID = EMP.BusinessEntityID\r\n\tLEFT JOIN Production.Product PRD\r\n\t\tON PRD.ProductID = SOD.ProductID\r\n\t\t\r\n\tGROUP BY\r\n\tSP.BusinessEntityID,\r\n\tDATEPART(YEAR, SOH.OrderDate)\r\n\r\nEND\r\nGO\n"})}),"\n",(0,s.jsx)(r.p,{children:"To utilize the stored procedure:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-SQL",children:"EXECUTE Demo.uspUpdateRepPerformance;\n"})}),"\n",(0,s.jsx)(r.p,{children:"Modify to insert in a Stored Procedure:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-SQL",children:"ALTER PROCEDURE Demo.uspUpdateRepPerformance\r\n\r\nAS\r\nBEGIN\r\n\tSET NOCOUNT ON;\r\n\t\r\n\t-- Delete data beofre inserting (specific case)\r\n\tTRUNCATE TABLE Demo.RepPerformance\r\n\t\r\n\tINSERT INTO Demo.RepPerformance\r\n\t(\r\n\t\tEmployeeID,\r\n\t\tSalesQuantity,\r\n\t\tSalesRevenue,\r\n\t\tOrderYear\r\n\t)\r\n\t\r\n\tSELECT \r\n\tSP.BusinessEntityID AS EmployeeID,\r\n\tSUM(SOD.OrderQty) AS SalesQuantity,\r\n\tSUM(SOD.OrderQty * PRD.ListPrice) AS SalesRevenue,\r\n\tDATEPART(YEAR, SOH.OrderDate) AS OrderYear\r\n\t\r\n\tFROM\r\n\tSales.SalesOrderHeader SOH\r\n\tLEFT JOIN Sales.SalesOrderDetail SOD\r\n\t\tON SOD.SaledOrderID = SOH.SalesOrderID\r\n\tLEFT JOIN Sales.SalesPerson SP\r\n\t\tON SP.BusinessEntityID = SOH.SalesPerson ID\r\n\tLEFT JOIN HumanResources.Employee EMP\r\n\t\tON EMP.BusinessEntityID = SP.BusinessEntityID\r\n\tLEFT JOIN Person.Person PER\r\n\t\tON PER.BusinessEntityID = EMP.BusinessEntityID\r\n\tLEFT JOIN Production.Product PRD\r\n\t\tON PRD.ProductID = SOD.ProductID\r\n\t\t\r\n\tGROUP BY\r\n\tSP.BusinessEntityID,\r\n\tDATEPART(YEAR, SOH.OrderDate)\r\n\r\nEND\r\nGO\n"})}),"\n",(0,s.jsx)(r.p,{children:"Parameters can also be included in the Stored Procedure:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-SQL",children:"ALTER PROCEDURE Demo.uspUpdateRepPerformance\r\n\t@OrderYear INT\r\nAS\r\nBEGIN\r\n\tSET NOCOUNT ON;\r\n\t\r\n\t-- Delete data beofre inserting (specific case)\r\n\tTRUNCATE TABLE Demo.RepPerformance\r\n\t\r\n\tINSERT INTO Demo.RepPerformance\r\n\t(\r\n\t\tEmployeeID,\r\n\t\tSalesQuantity,\r\n\t\tSalesRevenue,\r\n\t\tOrderYear\r\n\t)\r\n\t\r\n\tSELECT \r\n\tSP.BusinessEntityID AS EmployeeID,\r\n\tSUM(SOD.OrderQty) AS SalesQuantity,\r\n\tSUM(SOD.OrderQty * PRD.ListPrice) AS SalesRevenue,\r\n\tDATEPART(YEAR, SOH.OrderDate) AS OrderYear\r\n\t\r\n\tFROM\r\n\tSales.SalesOrderHeader SOH\r\n\tLEFT JOIN Sales.SalesOrderDetail SOD\r\n\t\tON SOD.SaledOrderID = SOH.SalesOrderID\r\n\tLEFT JOIN Sales.SalesPerson SP\r\n\t\tON SP.BusinessEntityID = SOH.SalesPerson ID\r\n\tLEFT JOIN HumanResources.Employee EMP\r\n\t\tON EMP.BusinessEntityID = SP.BusinessEntityID\r\n\tLEFT JOIN Person.Person PER\r\n\t\tON PER.BusinessEntityID = EMP.BusinessEntityID\r\n\tLEFT JOIN Production.Product PRD\r\n\t\tON PRD.ProductID = SOD.ProductID\r\n\t\t\r\n\tWHERE \r\n\tDATEPART(YEAR, SOH.OrderDate) = @OrderYear\r\n\t\t\r\n\tGROUP BY\r\n\tSP.BusinessEntityID,\r\n\tDATEPART(YEAR, SOH.OrderDate)\r\n\r\nEND\r\nGO\n"})}),"\n",(0,s.jsx)(r.p,{children:"To use a stored procedure with parameters we use:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-SQL",children:"EXEC Demo.uspUpdateRepPerformance @OrderDate = 2012;\n"})}),"\n",(0,s.jsx)(r.p,{children:"To delete a stored procedure:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-SQL",children:"DROP PROCEDURE <procedureName>\n"})})]})}function u(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(S,{...e})}):S(e)}},8453:(e,r,t)=>{t.d(r,{R:()=>o,x:()=>c});var n=t(6540);const s={},a=n.createContext(s);function o(e){const r=n.useContext(a);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(a.Provider,{value:r},e.children)}}}]);